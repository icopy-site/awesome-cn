<div class="github-widget" data-repo="Karneades/awesome-malware-persistence"></div>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6890694312814945" data-ad-slot="5473692530" data-ad-format="auto"  data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
## Awesome Malware Persistence [![Awesome](https://awesome.re/badge.svg)](https://github.com/sindresorhus/awesome)

&gt; 精选的恶意软件持久性工具和资源列表.

恶意软件持久性包括对手用来在重启、更改凭据和其他可能切断其访问的中断期间保持对系统的访问的技术. 用于持久性的技术包括允许他们在系统上保持立足点的任何访问、操作或配置更改，例如替换或劫持合法代码或添加启动代码.

[Main article about malware persistence](https://github.com/Karneades/malware-persistence/blob/master/README.md) 有更多的上下文和信息.



## Techniques

_持久性技术和检测._

### Generic

- [MITRE ATT&CK tactic "TA0003 - Persistence"](https://attack.mitre.org/tactics/TA0003/) - MITRE ATT&amp;CK 战术“TA0003 - 坚持”.
- [forensic artifact repository](https://github.com/ForensicArtifacts/artifacts) - 取证工件存储库涵盖了其工件中的持久性技术.
- [Sigma rules](https://github.com/Neo23x0/sigma/tree/master/rules)  - 涵盖持久性技术的 Sigma 规则. 您甚至可以使用诸如“--filter tag=attack.persistence”之类的过滤器，或者专门针对一种技术“tag=attack.t1084”.

### Linux

- [Linux Malware Persistence with Cron](https://www.sandflysecurity.com/blog/linux-malware-persistence-with-cron/) - 关于使用 cron 作业的 linux 持久性的博客文章.
- [Linux Persistence Techniques](https://research.splunk.com/stories/linux_persistence_techniques/) - 持久性技术列表.
- [Linux Red Team Persistence Techniques](https://www.linode.com/docs/guides/linux-red-team-persistence-techniques/) - 持久性技术列表.
- [ebpfkit](https://github.com/Gui774ume/ebpfkit) - 利用 eBPF 的 Rootkit.
- [TripleCross](https://github.com/h3xduck/TripleCross) - 利用 eBPF 的 Rootkit.

### macOS

- [theevilbit's series "Beyond the good ol' LaunchAgents"](https://theevilbit.github.io/tags/beyond/) - 除了 LaunchDaemons 或 LaunchAgents 之外的 macOS 持久性列表.
- [KnockKnock](https://github.com/objective-see/KnockKnock/blob/main/Plugins)  - 用于 macOS 的持久性检测工具，用于扫描 macOS 上的持久性机制. 具体的持久化位置可以在 [plugins](https://github.com/objective-see/KnockKnock/tree/main/Plugins) 文件夹，例如 [LaunchItems](https://github.com/objective-see/KnockKnock/blob/main/Plugins/LaunchItems.m#L21) 或者 [StartupScripts](https://github.com/objective-see/KnockKnock/blob/main/Plugins/StartupScripts.m#L22).
- [PoisonApple](https://github.com/CyborgSecurity/PoisonApple/blob/master/poisonapple/techniques.py) - 通过查看 PoisonApple 的源代码了解各种 macOS 持久性技术.
- [How malware persists on macOS](https://www.sentinelone.com/blog/how-malware-persists-on-macos/) - macOS 持久性机制列表.

### Windows

- [Hexacorn's blog](http://www.hexacorn.com/blog/category/autostart-persistence/) - Hexacorn 的持久性类别博客类别，包括系列“Beyond good ol&#39; Run key”.
- [Autoruns](https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns)  - 您可以通过在您自己的客户端上查看 Autoruns 的输出来了解检查了哪些 Windows 持久性机制. 在输出中可以看到类别和发现事物的不同位置.  Autoruns 的反汇编列出了被扫描的条目的子集.
- [PowerShell implementation of Autoruns](https://github.com/p0w3rsh3ll/AutoRuns/blob/master/AutoRuns.psm1)  - 另一种查找 Windows 持久性位置的方法是查看 PowerShell 版本的 Autoruns 的源代码. 奖励：每个 Autoruns 版本的覆盖持久性位置的历史记录也可以在模块文件的末尾找到，这太棒了！
- [Common malware persistence mechanisms](https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/) - 描述了不同向量的不同持久性机制.
- [Malware persistence techniques](https://www.andreafortuna.org/2017/07/06/malware-persistence-techniques/) - 对多种持久性机制的良好总结，从多个注册表项到更高级的机制，如 COM 劫持.
- [Detecting & Removing an Attacker's WMI Persistence](https://medium.com/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96) - 关于检测和删除 WMI 持久性的博客文章.
- [Windows Persistence using WinLogon](https://www.hackingarticles.in/windows-persistence-using-winlogon/) - Blog post about abusing WinLogon.
- [Untangling Kovter's persistence methods](https://blog.malwarebytes.com/threat-analysis/2016/07/untangling-kovter/)  - 关于隐藏在注册表中的 Kovter 持久化方法等的博客文章. 另一个是 [Threat Spotlight: Kovter Malware Fileless Persistence Mechanism](https://threatvector.cylance.com/en_us/home/threat-spotlight-kovter-malware-fileless-persistence-mechanism.html).
- [Persistence using GlobalFlags in Image File Execution Options – Hidden from Autoruns.exe](https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/) - 关于滥用 GlobalFlag 执行流程的博文.
- [Uncovering a MyKings Variant With Bootloader Persistence via Managed Detection and Response](https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-a-mykings-variant-with-bootloader-persistence-via-managed-detection-and-response/) - 关于引导加载程序持久性的博客文章.
- 关于 COM/CLSID 劫持的各种博客文章
  - [COM Object hijacking: the discreet way of persistence, 2014](https://www.gdatasoftware.com/blog/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence)
  - [Persistence – COM Hijacking, 2020](https://pentestlab.blog/2020/05/20/persistence-com-hijacking/)
  - [Abusing COM hijacking in combination with scheduled tasks, 2016](https://enigma0x3.net/2016/05/25/userland-persistence-with-scheduled-tasks-and-com-handler-hijacking/)
- [Hunting for persistence via Microsoft Exchange Server or Outlook](https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook) - 关于 Microsoft Exchange 服务器持久性的博客文章.

### Firmware

- [MoonBounce: the dark side of UEFI firmware](https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468) - 一篇关于一个特定 UEFI bootkit 的深入报道.

## Persistence Removal

 _用于删除持久性机制的工具和命令. 除了下面提到的工具，使用标准操作系统命令来删除持久性._

### Generic
- [Awesome Incident Response](https://github.com/meirwah/awesome-incident-response) - 使用工具和资源进行安全事件响应，旨在帮助安全分析师和 DFIR 团队.

### Windows
- [PowerSponse](https://github.com/swisscom/PowerSponse) - PowerSponse 包括用于清理持久性机制的各种命令.
- [Removing Backdoors – Powershell Empire Edition](https://www.n00py.io/2017/01/removing-backdoors-powershell-empire-edition/) - 各种博客文章处理 WMI 植入物的移除.
- [RegDelNull](https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull) - 删除带有空字节的注册表项 - 例如在运行键中用于规避.

## Detection Testing

 _用于测试检测的工具. 使用中描述的技术 [Persistence Techniques](#persistence-techniques) 创建这些文件或手动添加配置更改以测试您的检测._

- [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team) - Atomic Red Team 还支持 MITRE ATT&amp;CK 持久化技术，参见 eg [T1044 "File System Permissions Weakness"](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1044/T1044.yaml).
- [hasherezade persistence demos](https://github.com/hasherezade/persistence_demos) - 恶意软件使用的各种（也是非标准的）持久性方法来测试自己的检测，其中包括在 repo 中找到的 COM 劫持演示.
- [PoisonApple](https://github.com/CyborgSecurity/PoisonApple) - 在 macOS 上执行各种持久性技术.

## Prevention

_防止恶意持久化的工具._

### macOS

- [BlockBlock](https://github.com/objective-see/BlockBlock)  - 一种通过监视持久性位置并相应地保护它们来提供持续保护的工具. 类似于 KnockKnock 但用于阻塞.

## Collection

_持久性收集工具._

### Generic

- [Awesome Forensics](https://github.com/Cugu/awesome-forensics)  - 使用此列表中的工具，其中包括非常棒的免费（主要是开源）取证分析工具和资源. 它们有助于大规模收集持久性机制，例如通过使用远程取证工具.
- [osquery](https://osquery.readthedocs.io) - 客户端查询持久性机制.
- [OSSEC](https://github.com/ossec/ossec-hids) - 使用 HIDS 的规则和日志来检测配置更改.

### Linux

_There is no dedicated persistence collection tool for Linux I'm aware of. Use some of the tools from #General or standard OS commands for collection. Thanks for contributing links to Linux specific persistence collection tools._

* [Linux Security and Monitoring Scripts](https://github.com/sqall01/LSMS)  - 安全和监控脚本，可用于监控您的 Linux 安装以了解与安全相关的事件或进行调查. 在其他发现用于恶意软件持久性的 systemd 单元文件中.

### macOS

- [KnockKnock](https://www.objective-see.com/products/knockknock.html)  - 一种用于发现持续安装的软件以普遍揭示此类恶意软件的工具. 看 [GitHub repository too for the source code](https://github.com/objective-see/KnockKnock).
- [Dylib Hijack Scanner or DHS](https://www.objective-see.com/products/dhs.html)  - 一个简单的实用程序，可以扫描您的计算机以查找易受 dylib 劫持或已被劫持的应用程序. 看 [GitHub repository too for the source code](https://github.com/objective-see/DylibHijackScanner).

### Windows

- [Autoruns](http://technet.microsoft.com/en-us/sysinternals/bb963902)  - Windows 上一个强大的持久性收集工具是 Autoruns. 它从实时系统收集不同的类别和持久性信息，并且[在
  来自离线图像的有限方式](https://www.sans.org/blog/offline-autoruns-revisited-auditing-malware-persistence/). 有一个 UI 和一个命令行程序，输出格式可以设置为 CSV，然后可以将其导入到您选择的日志收集系统中.
- [AutorunsToWinEventLog.ps1](https://github.com/palantir/windows-event-forwarding/blob/master/AutorunsToWinEventLog/AutorunsToWinEventLog.ps1) - 您可以使用 AutorunsToWinEventLog 脚本将 Autoruns 输出转换为 Windows 事件日志并依赖标准 Windows 事件日志转发，而不是使用 CSV 输出并将这些文件复制到服务器.
- [PowerShell Autoruns](https://github.com/p0w3rsh3ll/AutoRuns) - Autoruns 的 PowerShell 版本.
- [PersistenceSniper](https://github.com/last-byte/PersistenceSniper) - 用于寻找植入 Windows 机器中的持久性的 Powershell 模块.
- [RegRipper](https://github.com/keydet89/RegRipper2.8) - 直接从注册表文件中提取各种持久性机制.
- [RECmd](https://github.com/EricZimmerman/RECmd) - 提取各种持久性机制，例如通过使用配置文件 [UserClassesASEPs](https://github.com/EricZimmerman/RECmd/blob/master/BatchExamples/UserClassesASEPs.reb) 提取用户的 CLSID 信息.
- [KAPE](https://www.kroll.com/en/insights/publications/cyber/kroll-artifact-parser-extractor-kape) - 该工具允许使用目标和模块收集各种预定义的工件，请参阅 [KapeFiles](https://github.com/EricZimmerman/KapeFiles) 其中包括持久性机制，除此之外还有一系列 [LNK files](https://github.com/EricZimmerman/KapeFiles/blob/master/Targets/Windows/LNKFilesAndJumpLists.tkape), [scheduled task files](https://github.com/EricZimmerman/KapeFiles/blob/master/Targets/Windows/ScheduledTasks.tkape) 和 [scheduled task listing](https://github.com/EricZimmerman/KapeFiles/blob/master/Modules/LiveResponse/schtasks.mkape) 或 [WMI repository auditing](https://github.com/EricZimmerman/KapeFiles/blob/master/Modules/LiveResponse/WMI-Repository-Auditing.mkape) 模块.

## Contributing

欢迎投稿！ 阅读 [contribution guidelines](https://github.com/Karneades/awesome-malware-persistence/blob/master/CONTRIBUTING.md) 第一的.
